<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="refresh" content="0; url=/first-run.html">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Redirecting...</title>
    <script>
      (function () {
        var langList = (navigator.languages && navigator.languages.length ? navigator.languages : [navigator.language || '']).map(function (l) {
          return (l || '').toLowerCase();
        });
        var mappings = [
          { match: ['zh-cn', 'zh-hans', 'zh-sg'], path: '/cn/first-run.html' },
          { match: ['zh-tw', 'zh-hant', 'zh-hk', 'zh-mo'], path: '/tw/first-run.html' },
          { match: ['ja', 'ja-jp'], path: '/ja/first-run.html' },
          { match: ['de', 'de-de', 'de-at', 'de-ch'], path: '/de/first-run.html' },
          { match: ['es', 'es-es', 'es-419', 'es-mx'], path: '/es/first-run.html' },
          { match: ['fr', 'fr-fr', 'fr-ca'], path: '/fr/first-run.html' },
          { match: ['pt', 'pt-br', 'pt-pt'], path: '/pt/first-run.html' },
          { match: ['ru', 'ru-ru'], path: '/ru/first-run.html' },
          { match: ['ko', 'ko-kr'], path: '/ko/first-run.html' },
          { match: ['vi', 'vi-vn'], path: '/vi/first-run.html' }
        ];
        var target = '/first-run.html';
        for (var i = 0; i < langList.length; i++) {
          var lang = langList[i];
          if (!lang) continue;
          for (var j = 0; j < mappings.length; j++) {
            var rule = mappings[j];
            for (var k = 0; k < rule.match.length; k++) {
              if (lang === rule.match[k] || lang.indexOf(rule.match[k] + '-') === 0) {
                target = rule.path;
                i = langList.length; // break outer loop
                break;
              }
            }
            if (target !== '/first-run.html') break;
          }
        }
        var suffix = window.location.search + window.location.hash;
        window.location.replace(target + suffix);
      })();
    </script>
  </head>
  <body>
    <p>Redirecting to the localized first-run page...</p>
    <p><a href="/first-run.html">Continue</a></p>
  </body>
</html>
